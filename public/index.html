<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Aus Emergency Map</title>
    <meta name="viewport" content="width=device-width" />
    <meta property="og:title" content="Aus Emergency Map" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://ausemergencymap.info" />
    <meta property="og:description" content="Fire and emergency information, Australia." />
    <!-- <meta property="og:image" content="" /> -->
    <link rel="stylesheet" href="./leaflet/leaflet.css" />
    <link rel="stylesheet" href="./leaflet.fullscreen/Control.FullScreen.css" />
    <link rel="stylesheet" href="./normalize/normalize.css">
    <link rel="stylesheet" href="./index.css">
  </head>
  <body>
    <div id="page">
      <div id="lmap" class="split"></div>
      <div id="panel" v-bind:class="showPanel ? 'split' : 'full'">
        <div id="panelSidebar">
          <div v-on:click.prevent="togglePanel()" title="toggle menu" id="panelToggleButton">
            <div style="font-size: 40px; line-height: 40px;">&#x21C6;</div>
            <div style="font-size: 10px; line-height: 10px; margin-top: -5px;">MENU</div>
          </div>
          <div title="Items" class="circle bg-blue">{{ geoFeatures.length }}</div>
          <div title="Resources" class="circle bg-red">{{ totalResources }}</div>
          <div title="Reload" class="circle reload" v-on:click.prevent="fetchData()">
            <div v-bind:class="'animate rotate ' + (data.vic.loading || data.nsw.loading ? 'running' : 'paused')">&#x21bb;</div>
          </div>
          <div title="Data Error" class="circle alert" v-if="data.vic.alert || data.nsw.alert" v-on:click.prevent="fetchData()">!</div>
          <div title="Scroll To Top" class="circle info" v-on:click.prevent="scrollTo('panelTop'); resetZoom()">&#x2302;</div>
          <div title="Filters" class="circle info" v-on:click.prevent="scrollTo('panelFilters')">&#9745;</div>
          <div title="List" class="circle info" v-on:click.prevent="scrollTo('panelList')">&#8801;</div>
          <div title="Info" class="circle info" v-on:click.prevent="scrollTo('panelInfo')">?</div>
        </div>
        <div id="panelInner">
          <span id="panelTop"></span>
          <h1 v-on:click.prevent="debug()">Aus Emergency</h1>
          <h2 id="panelFilters">Filters</h2>
          <p>
            Max age:
            <input type="number" min="0" max="100" step="1" v-model.lazy="maxAge" style="width: 3em;">
            hours
          </p>
          <p>
            <input type="range" min="0" value="10" max="100" step="1" v-model.lazy="maxAge" title="Max age (hours)">
          </p>
          <ol>
            <li v-for="src in ['vic', 'nsw']" v-if="src in filterTree" v-bind:key="src">
              <label>
                <input type="checkbox" v-model="filterTree[src]._show">
                <strong style="font-size: 110%;">{{ data[src].label }}</strong>
              </label>
              <ol>
                <li v-for="(obj, feedType) in filterTree[src]" v-if="feedType != '_show'" v-bind:key="feedType">
                  <label>
                    <input type="checkbox" v-model="obj._show">
                    <strong>{{ feedTypeLabel[feedType] }}</strong>
                  </label>
                  <small>
                    <button v-on:click.prevent="filterSet(obj, '_show', true)">all</button>
                    <button v-on:click.prevent="filterSet(obj, '_show', false)">none</button>
                  </small>
                  <ol>
                    <li>
                      <em>Category</em>
                      <ol>
                        <li v-for="(subcategories, category) in obj.category" v-if="category != '_show'" v-bind:key="feedType + category">
                          <label>
                            <input type="checkbox" v-model="subcategories._show">
                            {{ category }}
                          </label>
                          <ol>
                            <li v-for="(opt, subcategory) in subcategories" v-bind:key="feedType + category + subcategory">
                              <label v-if="subcategory != '_show'">
                                <input type="checkbox" v-model="opt._show">
                                {{ subcategory }}
                                <span class="badge bg-blue" v-if="opt.count">
                                  {{ opt.count }}
                                </span>
                              </label>
                            </li>
                          </ol>
                        </li>
                      </ol>
                    </li>
                    <li>
                      <em>Status</em>
                      <ol>
                        <li v-for="(opt, status) in obj.status" v-bind:key="feedType + status">
                          <label v-if="status != '_show'">
                            <input type="checkbox" v-model="opt._show">
                            {{ status }}
                            <span class="badge bg-blue" v-if="opt.count">
                              {{ opt.count }}
                            </span>
                          </label>
                        </li>
                      </ol>
                    </li>
                  </ol>
                </li>
              </ol>
            </li>
          </ol>
          <h2 id="panelList">List</h2>
          <p>
            <span class="badge bg-blue">{{ geoFeatures.length }}</span>
            Total Items
          </p>
          <p>
            <span class="badge bg-red">{{ totalResources }}</span>
            Total Resources
          </p>
          <p>
            Sort:
            <select v-model="sortBy">
              <option>updated</option>
              <option>created</option>
              <option>resources</option>
              <option>size</option>
            </select>
          </p>
          <ol>
            <li v-for="feature in geoFeatures" v-bind:key="fid(feature)" v-bind:id="'featureListItem' + fid(feature)" v-on:click.prevent="selectFeature(feature)" v-bind:class="'feature ' + (fid(feature) == featureSelected ? 'selected' : '')">
              <h3>{{ feature.properties.sourceTitle }}</h3>
              <p v-html="feature.properties.location"></p>
              <p v-if="feature.properties.resources">
                Resources: <span class="badge bg-red">{{ feature.properties.resources }}</span>
              </p>
              <p v-if="feature.properties.size">
                Size: {{ feature.properties.size }}
              </p>
              <p>
                {{ fdate(feature) }}
              </p>
            </li>
          </ol>
          <p v-if="geoFeatures.length == 0">No items.</p>
          <div id="panelInfo">
            <h2>About This Page</h2>
            <p>This page is in no way officially affiliated with any State Government or data provider.</p>
            <p>
              <a href="https://github.com/reillybeacom/aus-emergency-map">
                Source code available on Github
              </a>
            </p>
            <p>Proudly built with free, open-source software:</p>
            <ul>
              <li>
                <a href="http://leafletjs.com/">Leaflet</a>
              </li>
              <li>
                <a href="https://www.openstreetmap.org/about">OpenStreetMap</a>
              </li>
              <li>
                <a href="https://vuejs.org/">Vue.js</a>
              </li>
              <li>
                <a href="https://www.mozilla.org/en-US/firefox/">Firefox</a>
              </li>
            </ul>
            <p style="font-size: 70%; color: grey;">
              THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
              IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
              FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
              AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
              LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
              OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
              THE SOFTWARE.
            </p>
            <br/>
            <br/>
          </div>
        </div>
      </div>
    </div>
    <script src="./axios/axios.min.js"></script>
    <script src="./leaflet/leaflet.js"></script>
    <script src="./leaflet.fullscreen/Control.FullScreen.js"></script>
    <script src="./vue/vue.min.js"></script>
    <script src="./tokml/tokml.js"></script>
    <script src="./togpx/togpx.js"></script>
    <script src="./index.js"></script>
  </body>
</html>
